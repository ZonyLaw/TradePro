{% extends 'main.html' %} 
{% block content %}

<main>
  <p> Get the recent model prediction results for analysis, <a href = {% url 'export-model-results'%}>Click Here</a>.</p>
  <p><big>Current 1 hr Candle Stick size: {{ candle_size.one|floatformat:3 }}, direction: <b> {{trade.one}} </b> </big></p>
  <p><big>Current 4 hr Candle Stick size: {{ candle_size.four|floatformat:3 }}, direction: <b> {{trade.four}} </b> </big></p>
  <p>Last open price 1 hr ago: £{{ open_prices.3|floatformat:2 }} </p>
  <p>Last close price 1hr ago: £{{ close_prices.3|floatformat:2 }}</p>
  <p>Last open price 4 hrs ago: £{{ open_prices.0|floatformat:2 }} </p>
  
  <hr>
  <h1>Model predictions for reverse</h1>
  <p> Current candle direction <b>{{trade.one}}</b> </p>

  <table>
    <tr>
      <th>Profit/Loss</th>
      <th>Current Proba</th>
      <th>Reversed Proba (20 pips)</th>
      <th>Reversed Proba (40 pips)</th>
    </tr>
    

    {% for category, proba in pred_reverse.items %}
      <tr>
        <td>{{ category }}</td>
        {% if not forloop.last %}
          <td>{{ proba.0 }}%</td>
          <td>{{ proba.1 }}%</td>
          <td>{{ proba.2 }}%</td>
        {% else %}
          <td>{{ proba.0 }}</td>
          <td>{{ proba.1 }}</td>
          <td>{{ proba.2 }}</td>
        {% endif %}
      </tr>

      {% if forloop.revcounter0 == 1 %}
        <tr>
          <td colspan="4"><hr></td>
        </tr>
      {% endif %}
    
    {% endfor %}
  </table> 


  <h1>Model predictions for continue</h1>
  <p> Current candle direction <b>{{trade.one}}</b> </p>
  <table>
    <tr>
      <th>Profit/Loss</th>
      <th>Current Proba</th>
      <th>Continue Proba (20 pips)</th>
      <th>Continue Proba (40 pips)</th>
    </tr>
    
    {% for category, proba in pred_continue.items %}
     <tr>
        <td>{{ category }}</td>
        {% if not forloop.last %}
          <td>{{ proba.0 }}%</td>
          <td>{{ proba.1 }}%</td>
          <td>{{ proba.2 }}%</td>
        {% else %}
          <td>{{ proba.0 }}</td>
          <td>{{ proba.1 }}</td>
          <td>{{ proba.2 }}</td>
        {% endif %}
      </tr>
      
      {% if forloop.revcounter0 == 1 %}
        <tr>
          <td colspan="4"><hr></td>
        </tr>
      {% endif %}
    
    {% endfor %}

    </table> 
    
    <h1>Historical prediction for the last 4 hours</h1>
    <p> Current candle direction <b>{{trade.one}}</b> </p>
    <table>
      <tr>
        <th>Profit/Loss</th>
        <th>4 hr ago</th>
        <th>3 hr ago</th>
        <th>2 hr ago</th>
        <th>1 hr ago</th>
      </tr>

 
        <tr>
          <td>Open price</td>
          {% for price in open_prices %} 
      
            <td> £{{ price|floatformat:2 }}</td>

          {% endfor %} 
        </tr> 

      {% for category, proba in pred_historical.items %}
        <tr>
          <td>{{ category }}</td>
          {% if not forloop.last %}
            <td>{{ proba.0 }}%</td>
            <td>{{ proba.1 }}%</td>
            <td>{{ proba.2 }}%</td>
            <td>{{ proba.3 }}%</td>
          {% else %}
            <td>{{ proba.0 }}</td>
            <td>{{ proba.1 }}</td>
            <td>{{ proba.2 }}</td>
            <td>{{ proba.3 }}</td>
          {% endif %}
        </tr>
      
        {% if forloop.revcounter0 == 1 %}
          <tr>
            <td colspan="4"><hr></td>
          </tr>
        {% endif %}
      {% endfor %}
    </table> 


  <h2>Notes:</h2>
  <p>The model is only about 60 - 70% accurate predicting directions for a four hour timeframe.</p>
  <p>The analysis below show what are the probabilities if the trade directions reverse or continue based on previous trade direction.</p>
  <p>Should there be any major news or events, the model results could be invalidated!.</p>
  <p>High probabilities (e.g. 80% to 90%) has a chance of exhaustion. Either a retracement or hard reversal!</p>
  <p>If both the reversal and continuation results predict strongly in one direction, then it is a good chance it will go in that direction.</p>

</main>

{% endblock content %}