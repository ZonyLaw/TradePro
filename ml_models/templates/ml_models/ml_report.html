{% extends 'main.html' %} 
{% block content %}

<main class="formPage my-xl">
    <div class="content-box">

        <form action="" method="POST">
            {%csrf_token%} 
            {{form.as_p}}
            <input class="btn btn--sub btn--lg  my-md" type="submit" value="Submit" />
        </form>
       
        
        <h1>Trade Opportunities</h1>
            <p> To check the strength of model prediction, go to variability to test different pips movements.</p>
            <p> With current movement, summary of models prediction is: </p>
            <p><b> {{version_comment}} </b> </p>

            <p> Trade direction: <b> {{potential_trade}} </b></p>
            <p>Open price: <b> £{{open_prices.3|floatformat:2}} </b></p>
            <p style="color:blue;">Entry point: <b> £{{entry_point|floatformat:2}} </b></p>
            <p style="color:red;">Stop loss: <b> £{{stop_loss|floatformat:2}} </b></p>
            <p style="color:green;">Target point: <b> £{{exit_point|floatformat:2}} </b></p>
            <p>Volume: <b> {{ volume.3 }} </b></p>
            <p>Profit target can vary depending on the strength of the trade volume. It is recommended to take profit at 10, 20, 25 pips. 
                If volume is above 33 per minute (equivalent to 2000 per hour) then there is a strong chance it can exceed 10 pips in profits.</p>


        <h1>Market Information</h1>
            <p> Last Date price was extracted: <b>{{date}}</b> </p>
            <p><big>Current 1 hr Candle Stick size: {{ candle_size.one|floatformat:3 }}, direction: <b> {{trade.one}} </b> </big></p>
            <p><big>Current 4 hr Candle Stick size: {{ candle_size.four|floatformat:3 }}, direction: <b> {{trade.four}} </b> </big></p>
            <p>Last open price 1 hr ago: £{{ open_prices.3|floatformat:2 }} </p>
            <p>Last close price 1hr ago: £{{ close_prices.3|floatformat:2 }}</p>
            <p>Last open price 4 hrs ago: £{{ open_prices.0|floatformat:2 }} </p>

        <h1>Analysis Report</h1>
        <h2>History</h2>

        <table>
            <thead>

                <tr>
                    {% for label, headers in historical_labels.items %}
                        <th>{{ label }}</th>
                        {% for header in headers %}
                        <th>{{ header }}</th>
                        {% endfor %}
                    {% endfor %}
                </tr>
                    
            </thead>
            <tbody>


                {% for version, trades in historical_trade_results.items %}
                <tr>
                    <td>{{ version }}</td>
                    {% for trade in trades %}
                        <td>{{ trade }}</td>
                    {% endfor %}
                </tr>
                {% endfor %}

                <tr>
                    <td>Open price</td>
                    {% for price in open_prices %}
                    <td>£{{ price|floatformat:2 }}</td>
                    {% endfor %}

                </tr>

                <tr>
                    <td>Volume</td>
                    {% for vol in volume %}
                    <td>{{ vol }}</td>
                    {% endfor %}

                </tr>
                
            </tbody>
        </table>

        <h2>Sensitivity Test</h2>
            <table>
                <thead>
                    <tr>
                        <th>Movement</th>
                        <th>Sensitivity Results</th>
                    </tr>
                </thead>
                <tbody>

                    {% for variability, result  in pred_var_list.items %}
                    <tr>
                        <td>{{ variability }}</td>
                 
                            <td>{{ result }}</td>
                    </tr>
                    {% endfor %}
                    
                </tbody>
            </table>
        <h2>Reversed</h2>
        <p>This shows if the current prediction still holds when the next candle stick reversed. If it continues in the same direction, then reversed candle stick is only a retracement.</p>
        <table>
            <thead>

                <tr>
                    {% for label, headers in reverse_labels.items %}
                        <th>{{ label }}</th>
                        {% for header in headers %}
                        <th>{{ header }}</th>
                        {% endfor %}
                    {% endfor %}
                </tr>
                    
            </thead>
            <tbody>


                {% for version, trades in reverse_trade_results.items %}
                <tr>
                    <td>{{ version }}</td>
                    {% for trade in trades %}
                        <td>{{ trade }}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
                
            </tbody>
        </table>

        <h2>Continuation</h2>
        <p>This looks at how strong the movement. If it is strong, we would see same predictions of the same direction.</p>

        <table>
            <thead>

                <tr>
                    {% for label, headers in continue_labels.items %}
                        <th>{{ label }}</th>
                        {% for header in headers %}
                        <th>{{ header }}</th>
                        {% endfor %}
                    {% endfor %}
                </tr>
                    
            </thead>
            <tbody>

                {% for version, trades in continue_trade_results.items %}
                <tr>
                    <td>{{ version }}</td>
                    {% for trade in trades %}
                        <td>{{ trade }}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
                
            </tbody>
        </table>


</main>

{% endblock content %}